<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · YAXArraysToolbox.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://dpabon.github.io/YAXArraysToolbox.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>YAXArraysToolbox.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/dpabon/YAXArraysToolbox.jl/blob/main/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="YAXArraysToolbox"><a class="docs-heading-anchor" href="#YAXArraysToolbox">YAXArraysToolbox</a><a id="YAXArraysToolbox-1"></a><a class="docs-heading-anchor-permalink" href="#YAXArraysToolbox" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/dpabon/YAXArraysToolbox.jl">YAXArraysToolbox</a>.</p><ul><li><a href="#YAXArraysToolbox.aggregate_time-Tuple{Any}"><code>YAXArraysToolbox.aggregate_time</code></a></li><li><a href="#YAXArraysToolbox.altitude_mask_results_proc-Tuple{Any}"><code>YAXArraysToolbox.altitude_mask_results_proc</code></a></li><li><a href="#YAXArraysToolbox.altitude_masking_proc-Tuple{Any, Any}"><code>YAXArraysToolbox.altitude_masking_proc</code></a></li><li><a href="#YAXArraysToolbox.masking_proc-Tuple{YAXArrays.Cubes.YAXArray}"><code>YAXArraysToolbox.masking_proc</code></a></li><li><a href="#YAXArraysToolbox.masking_space-Tuple{Any, Any}"><code>YAXArraysToolbox.masking_space</code></a></li><li><a href="#YAXArraysToolbox.masking_time-Tuple{Any}"><code>YAXArraysToolbox.masking_time</code></a></li><li><a href="#YAXArraysToolbox.plot_space-Tuple{YAXArrays.Cubes.YAXArray}"><code>YAXArraysToolbox.plot_space</code></a></li><li><a href="#YAXArraysToolbox.plot_time-Tuple{YAXArrays.Cubes.YAXArray}"><code>YAXArraysToolbox.plot_time</code></a></li><li><a href="#YAXArraysToolbox.s4time-NTuple{6, Any}"><code>YAXArraysToolbox.s4time</code></a></li><li><a href="#YAXArraysToolbox.space4time_proc-Tuple{Any, Any}"><code>YAXArraysToolbox.space4time_proc</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="YAXArraysToolbox.aggregate_time-Tuple{Any}" href="#YAXArraysToolbox.aggregate_time-Tuple{Any}"><code>YAXArraysToolbox.aggregate_time</code></a> — <span class="docstring-category">Method</span></header><section><div><p><strong>Aggregate by time</strong></p><p><strong>Arguments:</strong></p><ul><li><code>cube_in</code> YAXArray Cube.</li><li><code>time_axis</code>: String. Name of the time axis.</li><li><code>new_resolution</code>: String. New temporal resolution can be <code>&quot;day&quot;</code>, <code>&quot;month&quot;</code>, <code>&quot;year&quot;</code>.</li><li><code>new_time_step</code>: Int64. Time step to be computed in the new time series. e.g. <code>new_resolution=&quot;day&quot;, new_time_step=8</code> will compute the function each 8 days. The new time dimension will only contain the days corresponding to the 8th day.</li><li><code>fun</code>: String. Function to be applied to aggregate the time. It can be &quot;median&quot;, &quot;mean&quot;, &quot;std&quot;, &quot;var&quot;, &quot;sum&quot;, &quot;quant&quot;, &quot;min&quot;, &quot;max&quot;.</li><li><code>p</code>: Float64 in the interval [0,1]. If <code>fun=quant</code> p is the value of the quantile. </li><li><code>skipMissing</code>: Boolean. Skip missing values when aggregating the data. If all values are missing, NaN is returned.</li><li><code>skipnan</code>: Boolean. Skip NaN values when aggregating the data. If all values are NaN, NaN is returned.</li><li><code>showprog</code>: Boolean. Progress Bar.</li><li><code>max_cache</code>: String. Maximum cache to read the data. It must be in MB e.g. &quot;100MB&quot; or in GB &quot;10GB&quot;.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">
esds = open_dataset(&quot;https://s3.bgc-jena.mpg.de:9000/esdl-esdc-v2.1.1/esdc-8d-0.25deg-184x90x90-2.1.1.zarr&quot;)
esdc = Cube(esds)

# Estimating the monthly LAI

lai_month = aggregate_time(esdc[Variable = &quot;leaf_area_index&quot;]; time_axis = &quot;time&quot;, new_resolution = &quot;month&quot;, new_time_step=1, fun=&quot;mean&quot;, p=nothing, skipMissing=true, skipnan=true, showprog=true, max_cache=&quot;1GB&quot;)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dpabon/YAXArraysToolbox.jl/blob/6d06e7a34c6e34525b44df7fd9c09bd673f25240/src/aggregate_time.jl#L382-L412">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="YAXArraysToolbox.altitude_mask_results_proc-Tuple{Any}" href="#YAXArraysToolbox.altitude_mask_results_proc-Tuple{Any}"><code>YAXArraysToolbox.altitude_mask_results_proc</code></a> — <span class="docstring-category">Method</span></header><section><div><p><strong>Topographical variability processor</strong></p><p><strong>Arguments:</strong></p><ul><li><p><code>cube_in_altitude</code> : Altitude YAXARRAY with two variables mean, and sd.</p></li><li><p><code>lon_axis_name</code> : String. Name of the longitude axis on the input cubes. By default <code>lon_axis_name = &quot;lon&quot;</code></p></li><li><p><code>lat_axis_name</code> :  String. Name of the longitude axis on the input cubes. By default <code>lon_axis_name = &quot;lat&quot;</code></p></li><li><p><code>variable_name</code> : String. Name of the Variable containing the variables &quot;mean&quot;, and &quot;sd&quot;.</p></li><li><p><code>winsize</code>: Edge size of the moving window on pixels. By default winsize = 5. E.g. <code>winsize = 5</code> will produce a moving window with 5^2 pixels.</p></li><li><p><code>showprog</code>: Show progress bar. By default <code>showprog = true</code></p></li></ul><p><strong>Output:</strong></p><p>The Topographical variability processor produces a YAXARRAY.cube with three Indicators:</p><ul><li><code>v1</code>: <span>$v_{1}=\dfrac{1}{n}\sum_{i = 1}^{n}\sigma_{h,i}$</span></li></ul><p>High values of <span>$v_{1}$</span> indicate hilly terrain over the considered scale, which should be discarded from the analysis.</p><ul><li><code>v2</code>: <span>$v_{2}=\vert \mu_{h} - \dfrac{1}{n} \sum_{i = 1}^{n}\mu_{h,i} \vert$</span></li></ul><p><span>$v_{2}$</span> indicates how different the mean elevation within the central pixel is from the average elevation in the local window.</p><ul><li><code>v3</code>: <span>$v_{3}= \vert \sigma_{h} - \dfrac{1}{n}\sum_{i = 1}^{n}\sigma_{h,i} \vert$</span></li></ul><p><span>$v_{3}$</span>: compares the central pixel&#39;s standard deviation of elevation with the standard deviation across the moving window.</p><p><strong>See also:</strong></p><ul><li><code>altitude_masking_proc</code> TO ADD LINK!!</li></ul><p><strong>Bibliography:</strong></p><ul><li>Duveiller, G., Hooker, J., &amp; Cescatti, A. (2018). A dataset mapping the potential biophysical effects of vegetation cover change. Scientific Data, 5(1), Article 1. <a href="https://doi.org/10.1038/sdata.2018.14">https://doi.org/10.1038/sdata.2018.14</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dpabon/YAXArraysToolbox.jl/blob/6d06e7a34c6e34525b44df7fd9c09bd673f25240/src/masking_altitude.jl#L37-L71">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="YAXArraysToolbox.altitude_masking_proc-Tuple{Any, Any}" href="#YAXArraysToolbox.altitude_masking_proc-Tuple{Any, Any}"><code>YAXArraysToolbox.altitude_masking_proc</code></a> — <span class="docstring-category">Method</span></header><section><div><p><strong>Topographical masking processor</strong></p><p><strong>Arguments:</strong></p><ul><li><p><code>cube_in_to_mask</code>: YAXArray Cube to be masked.</p></li><li><p><code>cube_in_altitude</code> : Altitude YAXARRAY with two variables mean, and sd.</p></li><li><p><code>lon_axis_name</code> : String. Name of the longitude axis on the input cubes. By default <code>lon_axis_name = &quot;lon&quot;</code></p></li><li><p><code>lat_axis_name</code> :  String. Name of the longitude axis on the input cubes. By default <code>lon_axis_name = &quot;lat&quot;</code></p></li><li><p><code>variable_name</code> : String. Name of the Variable containing the variables &quot;mean&quot;, and &quot;sd&quot;.</p></li><li><p><code>time_axis_name</code> : String or NaN. It is strongly recommended to pass this parameter if the cube to be masked contains a time dimension, otherwise <code>nothing</code>.</p></li><li><p><code>winsize</code>: Edge size of the moving window on pixels. By default <code>winsize = 5</code>. E.g. <code>winsize = 5</code> will produce a moving window with 5^2 pixels.</p></li><li><p><code>v1_thr</code> : Float. Threshold to mask values using <span>$v_{1}$</span> indicator. All values higer or equal to <code>v1_thr</code> are set to NaN. By default <code>v1_thr = 50</code> </p></li><li><p><code>v2_thr</code> : Float. Threshold to mask values using <span>$v_{2}$</span> indicator. All values higer or equal to <code>v2_thr</code> are set to NaN. By detault <code>v2_thr = 100</code></p></li><li><p><code>v3_thr</code> : Float. Threshold to mask values using <span>$v_{3}$</span> indicator. All values higer or equal to <code>v3</code> are set to NaN. By default <code>v3_thr = 100</code></p></li><li><p><code>showprog</code>: Boolean. Show progress bar. By default <code>showprog = true</code>.</p></li></ul><p><strong>Output:</strong></p><ul><li>YAXArray Datase with two variables:<ul><li><code>cube masked</code>: YAXArray Cube with same dimensions as <code>cube_in_to_mask</code>.</li><li><code>masked_pixels</code>: YAXArray Cube with same lat, lon, dimensions as cube_masked but with a single boolean variable indicating if the pixel was masked or not.</li></ul></li></ul><p><strong>Topographical variability indicators</strong></p><ul><li><code>v1</code>: <span>$v_{1}=\dfrac{1}{n}\sum_{i = 1}^{n}\sigma_{h,i}$</span></li></ul><p>High values of <span>$v_{1}$</span> indicate hilly terrain over the considered scale, which should be discarded from the analysis.</p><ul><li><code>v2</code>: <span>$v_{2}=\vert \mu_{h} - \dfrac{1}{n} \sum_{i = 1}^{n}\mu_{h,i} \vert$</span></li></ul><p><span>$v_{2}$</span> indicates how different the mean elevation within the central pixel is from the average elevation in the local window.</p><ul><li><code>v3</code>: <span>$v_{3}= \vert \sigma_{h} - \dfrac{1}{n}\sum_{i = 1}^{n}\sigma_{h,i} \vert$</span></li></ul><p><span>$v_{3}$</span>: compares the central pixel&#39;s standard deviation of elevation with the standard deviation across the moving window.</p><p><strong>See also</strong></p><ul><li><code>altitude_mask_results_proc</code> function TO ADD LINK!!</li></ul><p><strong>Bibliography</strong></p><ul><li>Duveiller, G., Hooker, J., &amp; Cescatti, A. (2018). A dataset mapping the potential biophysical effects of vegetation cover change. Scientific Data, 5(1), Article 1. <a href="https://doi.org/10.1038/sdata.2018.14">https://doi.org/10.1038/sdata.2018.14</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dpabon/YAXArraysToolbox.jl/blob/6d06e7a34c6e34525b44df7fd9c09bd673f25240/src/masking_altitude.jl#L134-L184">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="YAXArraysToolbox.masking_proc-Tuple{YAXArrays.Cubes.YAXArray}" href="#YAXArraysToolbox.masking_proc-Tuple{YAXArrays.Cubes.YAXArray}"><code>YAXArraysToolbox.masking_proc</code></a> — <span class="docstring-category">Method</span></header><section><div><p><strong>Masking processor</strong></p><p><strong>Arguments:</strong></p><ul><li><p><code>cube_in_to_mask</code>: YAXArray cube to be masked.</p></li><li><p><code>cube_rsquare</code>: Nothing, or YAXArray cube with the <span>$R^{2}$</span> variable. If set to <code>nothing</code> no mask is applied</p></li><li><p><code>rsquare_thr</code>: Float64. <span>$R^{2}$</span> threshold. All values lower than <code>rsquare_thr</code> are set to <code>NaN</code></p></li><li><p><code>cube_co_occurrence</code>: Nothing, or YAXArray cube with the co-occurrence variable. If set to <code>nothing</code> no mask is applied.</p></li><li><p><code>co_occurence_thr</code>: Float64. Co-occurence threshold. All values lower than <code>co_occurence_thr</code> are set to <code>NaN</code></p></li><li><p><code>cube_delta</code>: Nothing, or YAXArray cube with delta variable. If set to <code>nothing</code> no mask is applied.</p></li><li><p><code>minmax_delta</code>: Tuple. Minimum and maximum thresholds of delta variable. Values lower and higher than the thresholds are set to <code>NaN</code>. It is also possible to set any of the thresholds as <code>nothing</code> e.g. <code>(-1, nothing)</code> or <code>(nothing, 1)</code> in these cases only one threshold is applied.</p></li><li><p><code>time_dim</code>: Nothing, or String. Name of the time dimension. This dimensions needs to be present in all the cubes. If set to <code>nothing</code> no time dimension considered (It can result in slower computation time!). By default <code>time_dim = time</code></p></li><li><p><code>showprog</code>: Boolean. Show progress bar. By default <code>showprog = true</code></p></li></ul><p><strong>Output:</strong></p><ul><li>YAXArray cube masked.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dpabon/YAXArraysToolbox.jl/blob/6d06e7a34c6e34525b44df7fd9c09bd673f25240/src/masking_general.jl#L95-L120">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="YAXArraysToolbox.masking_space-Tuple{Any, Any}" href="#YAXArraysToolbox.masking_space-Tuple{Any, Any}"><code>YAXArraysToolbox.masking_space</code></a> — <span class="docstring-category">Method</span></header><section><div><p><strong>Masking using spatial dimension</strong></p><p>The masked vales are set as <code>NaN</code>!!.</p><p><strong>Arguments:</strong></p><ul><li><code>cube_in</code> YAXArray Cube to be masked.</li></ul><p>-<code>mask</code> YAXArray Cube without time dimension and with a single variable to be used as mask. All values equal to NaN or missing will be masked in cube<em>in. The mask will be applied to all the variables and time steps presented in ```cube</em>in```.</p><ul><li><code>lat_axis</code>: String. Name of the latitude axis.</li><li><code>lon_axis</code>: String. Name of the longitude axis.</li><li><code>val_mask</code>: NaN or missing. Value present in <code>mask</code> to be used as reference to mask <code>cube_in</code>. Must be NaN or missing.</li><li><code>showprog</code>: Boolean. Progress Bar.</li><li><code>max_cache</code>: String. Maximum cache to read the data. It must be in MB e.g. &quot;100MB&quot; or in GB &quot;10GB&quot;.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using YAXArrays, Zarr


axlist = [
RangeAxis(&quot;time&quot;, range(1, 20, length = 20)),
RangeAxis(&quot;x&quot;, range(1, 10, length = 10)),
RangeAxis(&quot;y&quot;, range(1, 5, length = 15)),
CategoricalAxis(&quot;Variable&quot;, [&quot;var1&quot;, &quot;var2&quot;]),
]


data = rand(20, 10, 15, 2)


ds = YAXArray(axlist, data, props)

axlist = [
RangeAxis(&quot;x&quot;, range(1, 10, length = 10)),
RangeAxis(&quot;y&quot;, range(1, 5, length = 15)),
CategoricalAxis(&quot;Variable&quot;, [&quot;var1&quot;]),
]


data = rand(10, 15, 1)

ds_mask = YAXArray(axlist, data)

masking_space(ds, ds_mask; lat_axis = &quot;x&quot;, lon_axis = &quot;y&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dpabon/YAXArraysToolbox.jl/blob/6d06e7a34c6e34525b44df7fd9c09bd673f25240/src/masking_space.jl#L26-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="YAXArraysToolbox.masking_time-Tuple{Any}" href="#YAXArraysToolbox.masking_time-Tuple{Any}"><code>YAXArraysToolbox.masking_time</code></a> — <span class="docstring-category">Method</span></header><section><div><p><strong>Masking using time dimension.</strong></p><p>The function implements two methods:</p><ol><li>Masking based on a threshold value for one of the variables presented in the cube. e.g., masking the values of all the variables presented in the cube where radiation is lower than X.</li><li>Masking based on the quantile threshold, where the quantile is estimated using the time series for each one of the variables presented in the cube.</li></ol><p>The masked vales are set as <code>NaN</code>.</p><p><strong>Arguments:</strong></p><ul><li><code>cube_in</code> YAXArray Cube.</li><li><code>time_axis</code>: String. Name of the time axis.</li><li><code>var_axis</code>: String. Name of the axis containing the variables.</li><li><code>var_mask</code>: String or nothing. Name of the variable to be used to mask the other variables. If String <code>val</code> must be an Int64 or Float64 number. If nothing, <code>val</code> must be nothing and <code>p</code> must be a Float64 in the interval [0,1].</li><li><code>val</code>: Float64 or nothing. The value of the threshold in <code>var_mask</code> to be used to mask all the variables in the cube. If <code>var_mask = nothing</code> then, <code>val=nothing</code></li><li><code>p</code>: Float64 or nothing. Quantile value used as a threshold to mask the variables.</li><li><code>comp</code>: String. Standard comparison operation between the threshold value and each one of the elements. <code>comp</code> Must be one of the following: &quot;==&quot;, &quot;!=&quot; &quot;&lt;&quot;, &quot;&lt;=&quot;, &quot;&gt;&quot;, &quot;&gt;=&quot;.</li><li><code>showprog</code>: Boolean. Progress Bar.</li><li><code>max_cache</code>: String. Maximum cache to read the data. It must be in MB e.g. &quot;100MB&quot; or in GB &quot;10GB&quot;.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using YAXArrays, Statistics, Zarr, NetCDF, YAXArraysToolbox

esds = open_dataset(
    &quot;https://s3.bgc-jena.mpg.de:9000/esdl-esdc-v2.1.1/esdc-8d-0.25deg-184x90x90-2.1.1.zarr&quot;,
)
esdc = Cube(esds)

esdc_small = esdc[
    lon = (-86, -35),
    lat = (-56, 14),
    time = (Date(2010), Date(2014)),
    Variable = [&quot;leaf_area_index&quot;, &quot;sensible_heat&quot;, &quot;potential_evaporation&quot;],
]

test = masking_time(
    esdc_small;
    time_axis = &quot;time&quot;,
    var_axis = &quot;Variable&quot;,
    var_mask = &quot;leaf_area_index&quot;,
    val = 0.2,
    comp = &quot;&lt;&quot;,
    showprog = true,
    max_cache = &quot;1GB&quot;,
)

plot_time(esdc_small; time_axis=&quot;time&quot;, var_axis=&quot;Variable&quot;, var = &quot;leaf_area_index&quot;, lat_axis = &quot;lat&quot;, lon_axis=&quot;lon&quot;, fun = &quot;min&quot;)

plot_time(test; time_axis=&quot;time&quot;, var_axis=&quot;Variable&quot;, var = &quot;leaf_area_index&quot;, lat_axis = &quot;lat&quot;, lon_axis=&quot;lon&quot;, fun = &quot;min&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dpabon/YAXArraysToolbox.jl/blob/6d06e7a34c6e34525b44df7fd9c09bd673f25240/src/masking_time.jl#L176-L231">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="YAXArraysToolbox.plot_space-Tuple{YAXArrays.Cubes.YAXArray}" href="#YAXArraysToolbox.plot_space-Tuple{YAXArrays.Cubes.YAXArray}"><code>YAXArraysToolbox.plot_space</code></a> — <span class="docstring-category">Method</span></header><section><div><p><strong>Plot Space/Maps</strong></p><p><strong>Arguments</strong></p><ul><li><code>cube_in</code>: YAXArray Cube.</li><li><code>time_axis</code>: String. Name of the time axis.</li><li><code>var_axis</code>: String. Name of the axis containing the variables.</li><li><code>var</code>: String or nothing. Name of the variable to be plotted. If nothing all the variables presented in the cube are plotted.</li><li><code>lat_axis</code>: String. Name of the latitude axis.</li><li><code>lon_axis</code>: String. Name of the longitute axis.</li><li><code>fun</code>: String. Name of the function used to collapse the spatial dimensions. It must be &quot;median&quot;, &quot;mean&quot;, &quot;std&quot;, &quot;var&quot;, &quot;sum&quot;, &quot;quant&quot;, &quot;min&quot;, or &quot;max&quot;.</li><li><code>p</code>: Float64. in the interval [0,1]. If <code>fun=quant</code> p is the value of the quantile.</li><li><code>colormap</code>: Color Map. By default: <code>colormap = Reverse(:batlow)</code></li><li><code>resolution</code>: Plot resolution. By default <code>resolution = (800, 300)</code>.</li><li><code>ncol</code>: Number of plots by column. By default <code>ncol = 1</code>.</li><li><code>nrow</code>: Number of plots by row. By default <code>ncol = 1</code>.</li><li><code>showprog</code>: Boolean. Progress Bar.</li><li><code>max_cache</code>: String. Maximum cache to read the data. It must be in MB e.g. &quot;100MB&quot; or in GB &quot;10GB&quot;.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">
cube_in = open_dataset(
    &quot;https://s3.bgc-jena.mpg.de:9000/esdl-esdc-v2.1.1/esdc-8d-0.25deg-1x720x1440-2.1.1.zarr&quot;,
)

cube_in = Cube(cube_in)


cube_in = cube_in[
    lon = (-9.0, 0.0),
    lat = (35, 40),
    time = (Date(2010), Date(2014)),
    Variable = [&quot;leaf_area_index&quot;, &quot;sensible_heat&quot;],
]

plot_space(cube_in; time_axis = &quot;time&quot;, resolution = (900, 600), var_axis = &quot;Variable&quot;, var =  &quot;leaf_area_index&quot;, fun = &quot;median&quot;)


metric = [&quot;median&quot;, &quot;mean&quot;, &quot;std&quot;, &quot;var&quot;, &quot;sum&quot;, &quot;quant&quot;, &quot;min&quot;, &quot;max&quot;]


for i in eachindex(metric)
    println(metric[i])
    plot_space(
        cube_in;
        time_axis = &quot;time&quot;,
        var_axis = &quot;Variable&quot;,
        lon_axis = &quot;lon&quot;,
        lat_axis = &quot;lat&quot;,
        var = &quot;sensible_heat&quot;,
        fun = metric[i],
        p = 0.2,
        showprog = true,
        max_cache = &quot;100MB&quot;,
    )
end



plot_space(
    cube_in;
    time_axis = &quot;time&quot;,
    var_axis = &quot;Variable&quot;,
    lon_axis = &quot;lon&quot;,
    lat_axis = &quot;lat&quot;,
    var = nothing,
    fun = &quot;median&quot;,
    resolution = (1200, 600),
    p = 0.2,
    showprog = true,
    max_cache = &quot;100MB&quot;,
    ncol = 2,
)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dpabon/YAXArraysToolbox.jl/blob/6d06e7a34c6e34525b44df7fd9c09bd673f25240/src/plot_space.jl#L81-L161">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="YAXArraysToolbox.plot_time-Tuple{YAXArrays.Cubes.YAXArray}" href="#YAXArraysToolbox.plot_time-Tuple{YAXArrays.Cubes.YAXArray}"><code>YAXArraysToolbox.plot_time</code></a> — <span class="docstring-category">Method</span></header><section><div><p><strong>Plot time</strong></p><p>The function allow to plot the time series of a given variables in a cube or all the variables present in a cube. As is expected that cubes contain spatial dimensions the spatial dimensions are collapsed using a function e.g., estimating the mean of the variable using the pixels of a certain area for each time step.</p><p><strong>Arguments:</strong></p><ul><li><code>cube_in</code> YAXArray Cube.</li><li><code>time_axis</code>: String. Name of the time axis.</li><li><code>var_axis</code>: String. Name of the axis containing the variables.</li><li><code>var</code>: String or nothing. Name of the variable to be plotted. If nothing all the variables presented in the cube are plotted.</li><li><code>lat_axis</code>: String. Name of the latitude axis.</li><li><code>lon_axis</code>: String. Name of the longitute axis.</li><li><code>fun</code>: String. Name of the function used to collapse the spatial dimensions. It must be &quot;median&quot;, &quot;mean&quot;, &quot;std&quot;, &quot;var&quot;, &quot;sum&quot;, &quot;quant&quot;, &quot;min&quot;, or &quot;max&quot;.</li><li><code>p</code>: Float64. in the interval [0,1]. If <code>fun=quant</code> p is the value of the quantile. </li><li><code>resolution</code>: Tuple. Plot resolution. By default <code>resolution = (600, 400)</code>. </li><li><code>ncol</code>: Number of plots by column. By default <code>ncol = 1</code>.</li><li><code>nrow</code>: Number of plots by row. By default <code>ncol = 1</code>.</li><li><code>showprog</code>: Boolean. Progress Bar.</li><li><code>max_cache</code>: String. Maximum cache to read the data. It must be in MB e.g. &quot;100MB&quot; or in GB &quot;10GB&quot;.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">cube_in = open_dataset(
    &quot;https://s3.bgc-jena.mpg.de:9000/esdl-esdc-v2.1.1/esdc-8d-0.25deg-1x720x1440-2.1.1.zarr&quot;,
)

cube_in = Cube(cube_in)
cube_in.Variable
cube_in = cube_in[
    lon = (-9.0, 0.0),
    lat = (35, 40),
    time = (Date(2010), Date(2014)),
    Variable = [&quot;leaf_area_index&quot;, &quot;sensible_heat&quot;],
]

plot_time(
    cube_in;
    time_axis = &quot;time&quot;,
    var_axis = &quot;Variable&quot;,
    lon_axis = &quot;lon&quot;,
    lat_axis = &quot;lat&quot;,
    var = nothing,
    fun = &quot;median&quot;,
    resolution = (900, 600),
    p = 0.2,
    showprog = true,
    max_cache = &quot;100MB&quot;,
    ncol = 2
)

plot_time(
    cube_in;
    time_axis = &quot;time&quot;,
    var_axis = &quot;Variable&quot;,
    lon_axis = &quot;lon&quot;,
    lat_axis = &quot;lat&quot;,
    var = &quot;sensible_heat&quot;,
    fun = &quot;median&quot;,
    p = 0.2,
    showprog = true,
    max_cache = &quot;100MB&quot;,
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dpabon/YAXArraysToolbox.jl/blob/6d06e7a34c6e34525b44df7fd9c09bd673f25240/src/plot_time.jl#L64-L131">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="YAXArraysToolbox.s4time-NTuple{6, Any}" href="#YAXArraysToolbox.s4time-NTuple{6, Any}"><code>YAXArraysToolbox.s4time</code></a> — <span class="docstring-category">Method</span></header><section><div><p>space4time(climate<em>cube, pfts</em>cube, pft_list::Vector{String}, winsize = 5, minpxl = 100, minDiffPxlspercentage = 40)</p><p>Compute the space for time analysis for a given climate variable.     ...</p><p><strong>Arguments</strong></p><pre><code class="nohighlight hljs">climate_cube: YAXARRAY cube with dimenssions: lon, lat, time.
pfts_cube: YAXARRAY cube with dimenssions: pfts, lat,lon, time.
...</code></pre><p><strong>Output</strong></p><pre><code class="nohighlight hljs">Three output cubes are generated.
out1: Summary statistics. YAXARRAY cube where summary_stat axis contains: 
* &quot;rsquare&quot;: XXXX 
* &quot;cumulative_variance&quot;: XXXX
* &quot;predicted&quot;: Prediction of Z for the central pixel with its real PFT combination.
out2:</code></pre><p>#Examples</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dpabon/YAXArraysToolbox.jl/blob/6d06e7a34c6e34525b44df7fd9c09bd673f25240/src/space4time.jl#L83-L104">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="YAXArraysToolbox.space4time_proc-Tuple{Any, Any}" href="#YAXArraysToolbox.space4time_proc-Tuple{Any, Any}"><code>YAXArraysToolbox.space4time_proc</code></a> — <span class="docstring-category">Method</span></header><section><div><p><strong>Space for time processor</strong></p><p><strong>Arguments:</strong></p><ul><li><code>cube_con</code> : YAXARRAY with the continous variable to be analyized.</li></ul><ul><li><code>cube_classes</code>: YAXARRAY with the discrete classes to be used in the space4time.</li></ul><ul><li><code>time_axis_name</code> : String or nothing. Name of the time axis on the input cubes. By default <code>time_axis_name = &quot;time&quot;</code>. if <code>time_axis_name = nothing</code>, not time dimension considered.</li></ul><ul><li><code>lon_axis_name</code> : String. Name of the longitude axis on the input cubes. By default <code>lon_axis_name = &quot;lon&quot;</code></li></ul><ul><li><code>lat_axis_name</code> :  String. Name of the longitude axis on the input cubes. By default <code>lon_axis_name = &quot;lat&quot;</code></li></ul><ul><li><code>classes_var_name</code> : String. Name of the Variable containing the discrete classes. By default <code>classes_var_name = &quot;classes&quot;</code>.</li></ul><ul><li><code>winsize</code>: Edge size of the moving window on pixels. By default winsize = 5. E.g. <code>winsize = 5</code> will produce a moving window with 5^2 pixels.</li></ul><ul><li><code>minpxl</code> : Minimum number of pixels in the moving window. By default minpxl = 25. Change accordindly to your <code>winsize</code> parameter.</li></ul><ul><li><code>minDiffPxlspercentage</code>: Percentage of minimum number pixels in the moving window that must have different compositions. Must be any value in the interval 30-100. By default minDiffPxlspercentage = 40</li></ul><ul><li><p><code>classes_vec</code>: A string vector with the names of the classes on <code>cube_classes</code> to be used. e.g. from MPI-BGC internal structure <code>classes_vec = [&quot;Evergreen_Needleleaf_Forests&quot;, &quot;Evergreen_Broadleaf_Forests&quot;, &quot;Deciduous_Needleleaf_Forests&quot;, &quot;Deciduous_Broadleaf_Forests&quot;, &quot;Mixed_Forests&quot;, &quot;Closed_Shrublands&quot;, &quot;Open_Shrublands&quot;, &quot;Woody_Savannas&quot;, &quot;Savannas&quot;, &quot;Grasslands&quot;, &quot;Permanent_Wetlands&quot;, &quot;Croplands&quot;, &quot;Urban_and_Built-up_Lands&quot;, &quot;Cropland/Natural_Vegetation_Mosaics&quot;, &quot;Permanent_Snow_and_Ice&quot;, &quot;Barren&quot;, &quot;Water_Bodies&quot;]</code></p></li><li><p><code>max_value</code>: Indicates if the scale of the presence of the discrete classes if from 0 to 1 or 0 to 100 if <code>max_value = 100</code> then the data is re-scaled from 0 to 1. By default <code>max_value = 1</code></p></li><li><p><code>showprog</code>: Show progress bar. By default <code>showprog = true</code></p></li><li><p><code>max_cache</code>: Size of the cache to allocate temporarily sections of the cubes. By default <code>max_cache = 1e8</code></p></li></ul><p><strong>Output:</strong></p><p>The <code>space4time_proc</code> produces a YAXARRAY.Dataset with three cubes:</p><ul><li>SummaryStats cube has one axis <code>summary_stat</code>, and three variables:<ul><li><code>rsquared</code>:  </li><li><code>cumulative_variance</code>:</li><li><code>predicted</code>:</li></ul></li><li><code>metrics_for_classes</code> cube has one axis <code>Values of Z for pure classes</code>, and two variables:<ul><li><code>estimated</code>:</li><li><code>estimated_error</code>:</li></ul></li><li>metrics<em>for</em>transitions has two axis <code>transitions</code> (all the transitions by pairs between the different classes), and <code>Differences</code> with three variables:<ul><li><code>delta</code>:</li><li><code>delta_error</code>:</li><li><code>coocurence</code>:</li></ul></li></ul><pre><code class="nohighlight hljs"></code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dpabon/YAXArraysToolbox.jl/blob/6d06e7a34c6e34525b44df7fd9c09bd673f25240/src/space4time.jl#L533-L576">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 29 May 2023 16:21">Monday 29 May 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
